<!DOCTYPE html>
<html>
  <head>
    <title><%=@path%></title>
    <style>

body {
  padding-top:0;
  padding-bottom: 30px;
  font-family: Verdana, Helvetica, sans;
  font-size: 12px;
  margin-left: 40px;
  width: 80%;
  background-color: #EDEDED;
}
h1 {
  margin:0;
  padding:0;
  float:left;
}
h1 em {
  font-size: smaller;
}
textarea {
  width: 100%;
  height: 500px;
  font-family: monospace;
}
#notice {
  background-color: yellow;
}
input#deleteBtn {
  float:right;
}
input[type=text] {
  width: 100%;
}
table {
  width: 100%
}
form#fileSelector {
  float:right;
}
form#createFileForm {
  border-top: 1px solid #CCC;
  margin-top: 10px;
  padding-top: 10px;
}

    </style>
  </head>
  <body>

<% if flash[:notice] %>
  <div id="notice"><%= flash[:notice] %></div>
<% end %>

<h1>fredit <em>front-end edit</em></h1>

<form id="fileSelector" action="<%=url_for%>">
  <select name="file">
    <% Fredit.editables.each_pair do |k, v| %>
      <optgroup label="<%= k %>">
        <% v.each do |path| %>
          <option value="<%= path %>" <%= @path == path ? 'selected=\"selected\"' : nil %>><%= Fredit.link(path)%></li>
        <% end %>
      </optgroup>
    <% end %>
  </select>
  <input type="submit" value="change file"/>
</form>

<form action="<%=url_for(:action => :update)%>" method="post">
  <input type="hidden" name="file" value="<%=@path%>"/>
  <textarea name='source'><%= @source %></textarea>

  <table>
    <tr>
      <td>Edit Message (optional):</td>
      <td>
        <input type="text" name="edit_message" value="" placeholder="Describe the edit " size="50"/>
      </td>
    </tr>
    <tr>
      <td>Edited By (required): </td>
      <td>
        <input type="text" name="commit_author" value="<%=session[:commit_author]%>" placeholder="Your Name <yourname@example.com>" size="50"/>
      </td>
    </tr>
    <tr>
      <td>Action:</td>
      <td>
        <input hidden="text" name="file_path" value="<%=@path%>" />
        <input type="submit" name="commit" value="update this file"/>
        <input id="deleteBtn" type="submit" name="commit" value="delete this file"/>
      </td>
    </tr>
  </table>
</form>

<form id="createFileForm" action="<%=url_for%>" method="get">
  <table>
    <tr>
      <td>Create file at path:</td>
      <td>
        <input type="text" name="new_path" value="" placeholder="<%=Fredit.editables[:views].first%>" size="50"/>
      </td>
    </tr>
    <tr>
      <td>Action:</td>
      <td>
        <input type="submit" name="commit" value="create file"/>
      </td>
    </tr>
  </table>
</form>



  </body>
</html>
